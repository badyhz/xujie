<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>ç¬¬ä¸€æ­¥ï¼šå¡«å†™æ—¥æœŸä¸80é“é¢˜æµ‹è¯„</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --sub: #1f2937;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --brand: #38bdf8;
      --accent: #22d3ee;
      --warn: #f59e0b;
      --ok: #10b981;
    }
    *{box-sizing:border-box}
    body {
      margin: 0;
      font-family: "Segoe UI", "PingFang SC", "Microsoft Yahei", sans-serif;
      background: radial-gradient(1200px 800px at 20% -10%, #0b1220, var(--bg));
      color: var(--text);
    }
    header {
      padding: 18px 22px;
      border-bottom: 1px solid #0b1220;
      background: linear-gradient(180deg, rgba(34,211,238,0.06), transparent);
      display:flex; align-items:center; justify-content:space-between;
    }
    header h1{font-size:18px;margin:0;color:#e6f6ff;letter-spacing:1px}
    .container { max-width: 1080px; margin: 22px auto; padding: 0 16px; }
    .card {
      background: linear-gradient(180deg, rgba(56,189,248,0.06), rgba(30,41,59,0.6));
      border:1px solid rgba(56,189,248,0.18);
      border-radius: 16px; padding: 18px;
      box-shadow: 0 6px 30px rgba(2,8,23,0.6), inset 0 0 40px rgba(34,211,238,0.05);
      backdrop-filter: blur(6px);
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
    }
    @media (min-width: 920px) {
      .grid { grid-template-columns: 1fr 2fr; }
    }
    label{color:#bfe9ff}
    input[type="date"]{
      background: var(--sub); color: var(--text); border:1px solid #0b1220;
      padding:8px 10px; border-radius:8px;
    }

    .q-wrap {
      background: rgba(15,23,42,0.6);
      border:1px solid rgba(148,163,184,0.15);
      border-radius:14px;
      padding:14px 14px 10px;
    }
    .q-title { font-size:14px; color:#dbeafe; margin-bottom:8px; line-height:1.5 }
    .q-meta { font-size:12px; color:var(--muted); margin-bottom:6px }
    .q-row { display:flex; align-items:center; gap:12px }
    input[type="range"]{
      width:100%;
      -webkit-appearance:none;
      height:6px; border-radius:8px;
      background: linear-gradient(90deg,#0b1220, #0ea5e9);
      outline:none;
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none; height:18px; width:18px; border-radius:50%;
      background: radial-gradient(#ffffff, #c0f2ff);
      border:2px solid #0ea5e9; box-shadow:0 0 12px rgba(56,189,248,0.8);
      cursor:pointer;
    }
    .val{min-width:44px;text-align:right;color:#c7f9ff}
    .scale { display:flex; justify-content:space-between; font-size:12px; color:var(--muted); margin-top:6px}
    .pager {
      display:flex; justify-content:space-between; gap:10px; margin-top:16px;
    }
    .btn {
      background: linear-gradient(180deg,#38bdf8,#0ea5e9);
      border:none; color:#04212d; font-weight:700;
      padding:10px 14px; border-radius:10px; cursor:pointer;
      box-shadow:0 6px 20px rgba(14,165,233,0.35);
    }
    .btn.secondary{
      background: linear-gradient(180deg,#1f2937,#0b1220);
      color:#e5e7eb; border:1px solid rgba(148,163,184,0.2);
    }
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .progress {
      height: 10px; background:#0b1220; border-radius:10px; overflow:hidden; border:1px solid rgba(56,189,248,0.2);
      margin-top:10px;
    }
    .bar { height:100%; width:0%; background: linear-gradient(90deg,#22d3ee,#38bdf8); box-shadow:0 0 14px rgba(34,211,238,0.6) inset }
    .legend {
      display:flex; gap:10px; flex-wrap:wrap; font-size:12px; color:#cceafb; margin-top:8px
    }
    .pill{
      border:1px solid rgba(148,163,184,0.25);
      padding:4px 8px; border-radius:999px; background:rgba(2,8,23,0.5)
    }
    .tips { font-size:12px; color:#9cc9ff; line-height:1.6 }
    .footer { margin-top:18px; font-size:12px; color:#7dd3fc }
  </style>
</head>
<body>
  <header>
    <h1>Step 1 / 4 Â· å…ˆå¤© & è‡ªæˆ‘æµ‹è¯„ï¼ˆæ—¥æœŸ + 80é¢˜ï¼‰</h1>
    <div class="legend">
      <span class="pill">0=å®Œå…¨ä¸åŒæ„</span>
      <span class="pill">50=ä¸­ç«‹</span>
      <span class="pill">100=å®Œå…¨åŒæ„</span>
    </div>
  </header>

  <div class="container">
    <div class="grid">
      <div class="card">
        <h3>ğŸ“… å¡«å†™ç”Ÿæ—¥</h3>
        <p class="tips">ç”¨äºè®¡ç®—è¥¿æ–¹æ˜Ÿåº§ï¼ˆä»…ä½œå…ˆå¤©åå¥½æ ‡ç­¾ï¼Œä¸å½±å“é¢˜ç›®è¯„åˆ†ï¼‰ã€‚</p>
        <label>ç”Ÿæ—¥
          <br />
          <input type="date" id="birthdate" />
        </label>
        <div class="footer">ç¤ºä¾‹ï¼š1996-08-08</div>

        <h3 style="margin-top:16px">ğŸ“ˆ ç­”é¢˜è¿›åº¦</h3>
        <div class="progress"><div class="bar" id="bar"></div></div>
        <div class="tips" id="pageInfo" style="margin-top:6px">ç¬¬ 1 / 8 é¡µï¼ˆæ¯é¡µ 10 é¢˜ï¼‰</div>

        <div class="pager">
          <button class="btn secondary" id="prevBtn" disabled>â† ä¸Šä¸€é¡µ</button>
          <button class="btn" id="nextBtn">ä¸‹ä¸€é¡µ â†’</button>
        </div>

        <div class="pager">
          <button class="btn" id="saveBtn" disabled>ä¿å­˜å¹¶è¿›å…¥ ç¬¬äºŒæ­¥ï¼ˆæ ‡ç­¾é€‰æ‹©ï¼‰ â†’</button>
        </div>

        <p class="tips" style="margin-top:12px">
          è¯´æ˜ï¼šæœ¬é‡è¡¨è¦†ç›– <b>å¤§äº”äººæ ¼</b>ï¼ˆå¼€æ”¾æ€§/å°½è´£æ€§/å¤–å‘æ€§/å®œäººæ€§/æƒ…ç»ªç¨³å®šæ€§ï¼‰ç»´åº¦ï¼Œ<br/>
          æ¯ä¸ªç‰¹å¾è®¾ç½®<b>æ­£å‘</b>ä¸<b>åå‘</b>ä¸¤é“é¢˜ï¼Œæ€»è®¡ 80 é¢˜ã€‚ç³»ç»Ÿå°†è‡ªåŠ¨åšåå‘è®¡åˆ†ä¸åŠ æƒå¹³å‡ã€‚
        </p>
      </div>

      <div id="qPanel" class="card" style="min-height:560px">
        <h3>ğŸ§  é¢˜ç›®ï¼ˆ0~100 æ»‘æ†ï¼‰</h3>
        <div id="questions"></div>
      </div>
    </div>
  </div>

  <script>
    // ============ é¢˜åº“ï¼ˆ40 ç‰¹å¾ Ã— æ­£/åå‘ = 80 é“ï¼‰ ============
    // dim: O/C/E/A/Nï¼Œå¯¹åº” å¤§äº”ï¼›rev: æ˜¯å¦åå‘è®¡åˆ†
    const PAIRS = [
      // â€”â€” å¼€æ”¾æ€§ï¼ˆOï¼‰
      { pos:"æˆ‘ä¼šä¸»åŠ¨æ¢ç´¢æ–°æƒ³æ³•ã€æ–°å·¥å…·æˆ–æ–°æ–¹æ³•ã€‚", neg:"æˆ‘æ›´æ„¿æ„éµå¾ªæ—§æœ‰åšæ³•ï¼Œé¿å…å°è¯•æ–°ç‚¹å­ã€‚", dim:"O" },
      { pos:"æˆ‘å¯¹è‰ºæœ¯ã€å®¡ç¾æˆ–åˆ›æ„è¡¨è¾¾æœ‰çœŸå®å…´è¶£ã€‚", neg:"è‰ºæœ¯ä¸åˆ›æ„å¯¹æˆ‘æ¥è¯´å¯æœ‰å¯æ— ã€‚", dim:"O" },
      { pos:"æˆ‘èƒ½åœ¨ä¸ç¡®å®šä¸­ä¿æŒå¥½å¥‡ï¼Œæ„¿æ„è¯•é”™ã€‚", neg:"é¢å¯¹ä¸ç¡®å®šæ€§æˆ‘ä¼šé€€ç¼©æˆ–å›é¿ã€‚", dim:"O" },
      { pos:"æˆ‘å–œæ¬¢è·¨å­¦ç§‘å­¦ä¹ å¹¶è¿›è¡ŒçŸ¥è¯†è¿ç§»ã€‚", neg:"æˆ‘æ›´å€¾å‘åœ¨ç†Ÿæ‚‰çš„å•ä¸€é¢†åŸŸæ‰“è½¬ã€‚", dim:"O" },
      { pos:"æˆ‘ç»å¸¸æ„æ€æ–°ç‚¹å­å¹¶ä»˜è¯¸åŸå‹ã€‚", neg:"æˆ‘å¾ˆå°‘äº§ç”Ÿæ–°ç‚¹å­ï¼Œä¹Ÿå¾ˆå°‘å°è¯•åŸå‹ã€‚", dim:"O" },
      { pos:"æˆ‘ä¹äºæ¥å—ä¸åŒæ–‡åŒ–ä¸è§‚ç‚¹ã€‚", neg:"æˆ‘å¯¹ä¸åŒæ–‡åŒ–æˆ–è§‚ç‚¹è¾ƒä¸å®½å®¹ã€‚", dim:"O" },
      { pos:"æˆ‘èƒ½æŠŠæŠ½è±¡æ¦‚å¿µè½¬åŒ–ä¸ºå®é™…æ–¹æ¡ˆã€‚", neg:"æŠ½è±¡æ¦‚å¿µå¯¹æˆ‘æ— ç”¨ï¼Œéš¾è½¬åŒ–ä¸ºè¡ŒåŠ¨ã€‚", dim:"O" },
      { pos:"æˆ‘ä¼šä¸»åŠ¨è¿½è¸ªè¶‹åŠ¿å¹¶å¿«é€Ÿè¿­ä»£ã€‚", neg:"æˆ‘å¯¹è¶‹åŠ¿å˜åŒ–ä¸æ•æ„Ÿï¼Œä¹Ÿä¸æƒ³è°ƒæ•´æ–¹å‘ã€‚", dim:"O" },

      // â€”â€” å°½è´£æ€§ï¼ˆCï¼‰
      { pos:"æˆ‘èƒ½æŠŠå¤§ç›®æ ‡æ‹†è§£ä¸ºå¯æ‰§è¡Œçš„å°æ­¥éª¤ã€‚", neg:"æˆ‘å¸¸å¸¸åªåœç•™åœ¨æƒ³æ³•å±‚é¢ä¸å»æ‹†è§£ã€‚", dim:"C" },
      { pos:"æˆ‘ä¼šæŒ‰ä¼˜å…ˆçº§ç®¡ç†äº‹åŠ¡å¹¶å¦‚æœŸå®Œæˆã€‚", neg:"æˆ‘å¸¸å¸¸è¢«çäº‹æ‰“æ–­ï¼Œéš¾ä»¥æŒ‰æ—¶å®Œæˆã€‚", dim:"C" },
      { pos:"æˆ‘æ—¥å¸¸æœ‰èŠ‚å¾‹ï¼ˆä½œæ¯ã€å¤ç›˜ã€å¤åˆ©ï¼‰ã€‚", neg:"æˆ‘çš„ä½œæ¯æ··ä¹±ï¼Œç¼ºå°‘å¤ç›˜ä¸èŠ‚å¾‹ã€‚", dim:"C" },
      { pos:"æˆ‘é‡åˆ°é˜»åŠ›ä¹Ÿèƒ½æŒç»­æ¨è¿›ã€‚", neg:"é‡é˜»æ—¶æˆ‘å®¹æ˜“æ”¾å¼ƒæˆ–æ‹–å»¶ã€‚", dim:"C" },
      { pos:"æˆ‘åœ¨å…³é”®æ—¶åˆ»èƒ½ä¿æŒé«˜åº¦æ‰§è¡ŒåŠ›ã€‚", neg:"å…³é”®èŠ‚ç‚¹æˆ‘å¸¸å¸¸çŠ¶æ€ä¸‹æ»‘ã€‚", dim:"C" },
      { pos:"æˆ‘èƒ½æƒè¡¡å®Œç¾ä¸æ•ˆç‡å¹¶åšå–èˆã€‚", neg:"æˆ‘å¸¸é™·å…¥å®Œç¾ä¸»ä¹‰è€½è¯¯è¿›åº¦ã€‚", dim:"C" },
      { pos:"æˆ‘å¯¹ç»†èŠ‚ä¸è´¨é‡æœ‰ç¨³å®šçš„è¿½æ±‚ã€‚", neg:"æˆ‘å¯¹ç»†èŠ‚æŠŠæ§è¾ƒå¼±ï¼Œå¸¸æœ‰ç–æ¼ã€‚", dim:"C" },
      { pos:"æˆ‘ä¼šè®¾ç½®è¾¹ç•Œï¼Œä¿æŠ¤æ·±åº¦å·¥ä½œæ—¶é—´ã€‚", neg:"æˆ‘éš¾ä»¥æ‹’ç»æ‰“æ–­ï¼Œæ·±åº¦å·¥ä½œä¸è¶³ã€‚", dim:"C" },

      // â€”â€” å¤–å‘æ€§ï¼ˆEï¼‰
      { pos:"æˆ‘åœ¨ç¾¤ä½“ä¸­è‡ªç„¶åœ°ä¸»åŠ¨å‘è¨€ä¸å¸¦åŠ¨æ°”æ°›ã€‚", neg:"æˆ‘åœ¨ç¾¤ä½“ä¸­å€¾å‘æ²‰é»˜æˆ–å›é¿å‘è¨€ã€‚", dim:"E" },
      { pos:"æˆ‘ç»“è¯†æ–°æœ‹å‹æ—¶é€šå¸¸æ„Ÿåˆ°å…´å¥‹è€Œéç„¦è™‘ã€‚", neg:"æˆ‘ä¸é™Œç”Ÿäººäº¤æµå¸¸ä»¤äººç´§å¼ æˆ–ç–²æƒ«ã€‚", dim:"E" },
      { pos:"æˆ‘èƒ½æŠŠæƒ³æ³•å£å¤´è¡¨è¾¾å¾—æ¸…æ™°æœ‰æ„ŸæŸ“åŠ›ã€‚", neg:"æˆ‘å£å¤´è¡¨è¾¾è¾ƒå¼±ï¼Œå¸¸éš¾ä»¥é˜è¿°æƒ³æ³•ã€‚", dim:"E" },
      { pos:"æˆ‘æ„¿æ„åœ¨å…¬å¼€åœºåˆæ‰¿æ‹…å¯è§è§’è‰²ã€‚", neg:"æˆ‘å°½é‡é¿å…æ‰¿æ‹…å…¬å¼€ä¸å¯è§è§’è‰²ã€‚", dim:"E" },
      { pos:"æˆ‘ä¸äººäº’åŠ¨èƒ½å¿«é€Ÿå»ºç«‹è¿æ¥ä¸çƒ­åº¦ã€‚", neg:"ä¸äººäº’åŠ¨å¸¸å¸¸éœ€è¦å¾ˆä¹…æ‰èƒ½çƒ­èµ·æ¥ã€‚", dim:"E" },
      { pos:"æˆ‘æœ‰ä¸€å®šçš„ä¸»å¯¼/ä¸»æŒè®¨è®ºçš„èƒ½åŠ›ã€‚", neg:"æˆ‘ç¼ºä¹ä¸»æŒè®¨è®ºæˆ–ç»„ç»‡å¯¹è¯çš„èƒ½åŠ›ã€‚", dim:"E" },
      { pos:"æˆ‘äº«å—å¤šäººåä½œå¸¦æ¥çš„èƒ½é‡ä¸èŠ‚å¥ã€‚", neg:"å¤šäººåä½œè®©æˆ‘åˆ†å¿ƒï¼Œä½æ•ˆè€Œç–²æƒ«ã€‚", dim:"E" },
      { pos:"æˆ‘åœ¨ä¼šè®®/æ´»åŠ¨ä¸­ç»å¸¸æˆä¸ºæ¨è¿›è€…ã€‚", neg:"æˆ‘åœ¨ä¼šè®®/æ´»åŠ¨ä¸­é€šå¸¸åªè¢«åŠ¨å‚ä¸ã€‚", dim:"E" },

      // â€”â€” å®œäººæ€§ï¼ˆAï¼‰
      { pos:"æˆ‘èƒ½åœ¨åˆ†æ­§ä¸­ä¿æŒå°Šé‡ä¸åˆä½œã€‚", neg:"é‡åˆ°åˆ†æ­§æˆ‘å®¹æ˜“å¯¹æŠ—æˆ–è®¥è®½ã€‚", dim:"A" },
      { pos:"æˆ‘æ„¿æ„å€¾å¬ä»–äººéœ€æ±‚å¹¶å°è¯•æˆå…¨ã€‚", neg:"æˆ‘æ›´å¤šä¼˜å…ˆè‡ªå·±çš„éœ€æ±‚ä¸ç«‹åœºã€‚", dim:"A" },
      { pos:"æˆ‘èƒ½åœ¨åŸåˆ™ä¸åŒç†å¿ƒä¹‹é—´å–å¾—å¹³è¡¡ã€‚", neg:"æˆ‘è¦ä¹ˆè¿‡åº¦è¿å°±ï¼Œè¦ä¹ˆè¿‡åº¦å¼ºç¡¬ã€‚", dim:"A" },
      { pos:"æˆ‘ä¸äººå»ºç«‹äº’ä¿¡å…³ç³»çš„é€Ÿåº¦è¾ƒå¿«ã€‚", neg:"æˆ‘å¯¹ä»–äººæ™®éä¸ä¿¡ä»»ï¼Œå»ºç«‹å…³ç³»å¾ˆæ…¢ã€‚", dim:"A" },
      { pos:"æˆ‘ä¹äºç»™äºˆæ­£å‘åé¦ˆä¸è®¤å¯ã€‚", neg:"æˆ‘å¾ˆå°‘ä¸»åŠ¨è¡¨è¾¾æ„Ÿè°¢æˆ–è®¤å¯ã€‚", dim:"A" },
      { pos:"æˆ‘å†²çªæ—¶èƒ½æ§åˆ¶è¯­æ°”ä¸è¡¨è¾¾æ–¹å¼ã€‚", neg:"æˆ‘å†²çªæ—¶å®¹æ˜“æƒ…ç»ªåŒ–æˆ–è®½åˆºæŒ–è‹¦ã€‚", dim:"A" },
      { pos:"æˆ‘ä¹äºåˆä½œå…±èµ¢ï¼Œé¿å…é›¶å’Œæ€ç»´ã€‚", neg:"æˆ‘æ›´å¸¸ä»¥è¾“èµ¢æ¥å®šä¹‰å…³ç³»ã€‚", dim:"A" },
      { pos:"æˆ‘åœ¨å›¢é˜Ÿä¸­å¸¸è¢«è§†ä¸ºå¯é çš„åˆä½œè€…ã€‚", neg:"æˆ‘åœ¨å›¢é˜Ÿåä½œä¸­å¸¸æ˜¾å¾—ä¸åˆæ‹ã€‚", dim:"A" },

      // â€”â€” æƒ…ç»ªï¼ˆNï¼šè¿™é‡Œå­˜â€œç¥ç»è´¨â€ï¼Œæœ€ç»ˆè½¬ä¸ºâ€œæƒ…ç»ªç¨³å®šæ€§â€ï¼‰
      { pos:"é¢å¯¹å‹åŠ›æˆ‘èƒ½è¾ƒå¿«æ¢å¤åˆ°ç¨³å®šçŠ¶æ€ã€‚", neg:"é¢å¯¹å‹åŠ›æˆ‘ä¼šåå¤å›æƒ³å¹¶éš¾ä»¥å¹³å¤ã€‚", dim:"N" },
      { pos:"æˆ‘èƒ½åˆ†è¾¨æƒ…ç»ªä¸äº‹å®å¹¶é¿å…è¿‡åº¦è§£è¯»ã€‚", neg:"æˆ‘å¸¸æŠŠæƒ…ç»ªå½“äº‹å®è€Œæ”¾å¤§é—®é¢˜ã€‚", dim:"N" },
      { pos:"æˆ‘é‡æŒ«æ—¶èƒ½è‡ªæˆ‘å®‰æŠšå¹¶å¯»æ±‚æ”¯æŒã€‚", neg:"æˆ‘é‡æŒ«æ—¶å®¹æ˜“è‡ªè´£æˆ–å­¤ç«‹è‡ªå·±ã€‚", dim:"N" },
      { pos:"æˆ‘èƒ½ç”¨è§„å¾‹ç”Ÿæ´»ç¨³å®šæƒ…ç»ªæ³¢åŠ¨ã€‚", neg:"æˆ‘ä½œæ¯å¤±è¡¡ï¼Œæƒ…ç»ªå¤šå—å…¶å½±å“ã€‚", dim:"N" },
      { pos:"æˆ‘å¯¹è´Ÿé¢è¯„ä»·çš„è€å—åº¦å°šå¯ã€‚", neg:"è´Ÿé¢è¯„ä»·ä¼šé•¿æ—¶é—´å½±å“æˆ‘çš„çŠ¶æ€ã€‚", dim:"N" },
      { pos:"æˆ‘èƒ½åœ¨æœªçŸ¥ä¸å˜åŠ¨ä¸­ä¿æŒåŸºæœ¬é•‡å®šã€‚", neg:"æœªçŸ¥ä¸å˜åŠ¨é€šå¸¸è®©æˆ‘ç„¦è™‘ä¸å®‰ã€‚", dim:"N" },
      { pos:"æˆ‘åŸºæœ¬ä¸è¢«å°äº‹ç‰µåŠ¨æ•´ä¸ªä¸€å¤©çš„å¿ƒæƒ…ã€‚", neg:"å°äº‹ä¹Ÿä¼šè®©æˆ‘æƒ…ç»ªä½è½å¾ˆä¹…ã€‚", dim:"N" },
      { pos:"æˆ‘èƒ½è¯†åˆ«å¹¶è°ƒæ•´éç†æ€§æƒ³æ³•ã€‚", neg:"æˆ‘å¸¸é™·å…¥â€œç¾éš¾åŒ–â€æˆ–â€œéé»‘å³ç™½â€çš„æƒ³æ³•ã€‚", dim:"N" },
    ];
    // å±•å¼€ä¸º 80 é¢˜
    const QUESTIONS = [];
    let idx = 1;
    PAIRS.forEach(p => {
      QUESTIONS.push({ id: idx++, text: p.pos, dim: p.dim, rev: false });
      QUESTIONS.push({ id: idx++, text: p.neg, dim: p.dim, rev: true  });
    });

    // ============ åˆ†é¡µ ============
    const PAGE_SIZE = 10;
    const totalPages = Math.ceil(QUESTIONS.length / PAGE_SIZE);
    let currentPage = 1;

    // å›ç­”ç¼“å­˜
    const answers = {}; // id -> 0..100

    const $qs = document.getElementById("questions");
    const $bar = document.getElementById("bar");
    const $pageInfo = document.getElementById("pageInfo");
    const $prev = document.getElementById("prevBtn");
    const $next = document.getElementById("nextBtn");
    const $save = document.getElementById("saveBtn");

    function renderPage() {
      $qs.innerHTML = "";
      const start = (currentPage-1)*PAGE_SIZE;
      const pageItems = QUESTIONS.slice(start, start+PAGE_SIZE);

      pageItems.forEach(q => {
        const val = (answers[q.id] ?? 50);
        const el = document.createElement("div");
        el.className = "q-wrap";
        el.innerHTML = `
          <div class="q-meta">é¢˜ ${q.id} Â· ç»´åº¦ï¼š${dimName(q.dim)} ${q.rev ? "ï¼ˆåå‘è®¡åˆ†ï¼‰" : ""}</div>
          <div class="q-title">${q.text}</div>
          <div class="q-row">
            <input type="range" min="0" max="100" value="${val}" data-id="${q.id}" />
            <div class="val" id="v${q.id}">${val}</div>
          </div>
          <div class="scale"><span>å®Œå…¨ä¸åŒæ„</span><span>ä¸­ç«‹</span><span>å®Œå…¨åŒæ„</span></div>
        `;
        $qs.appendChild(el);
      });

      // ç»‘å®šäº‹ä»¶
      $qs.querySelectorAll('input[type="range"]').forEach(r => {
        r.addEventListener("input", e => {
          const id = +e.target.dataset.id;
          answers[id] = +e.target.value;
          const v = document.getElementById("v"+id);
          if (v) v.textContent = answers[id];
          updateProgress();
        });
      });

      // æ›´æ–°è¿›åº¦ä¸æŒ‰é’®
      $pageInfo.textContent = `ç¬¬ ${currentPage} / ${totalPages} é¡µï¼ˆæ¯é¡µ ${PAGE_SIZE} é¢˜ï¼‰`;
      $prev.disabled = currentPage===1;
      $next.disabled = currentPage===totalPages;
      updateProgress();
      updateSaveState();
    }

    function updateProgress() {
      const answeredCount = Object.keys(answers).length;
      const pct = Math.round(answeredCount / QUESTIONS.length * 100);
      $bar.style.width = pct + "%";
    }

    function updateSaveState() {
      const full = Object.keys(answers).length === QUESTIONS.length;
      $save.disabled = !full;
    }

    function dimName(code){
      return {O:"å¼€æ”¾æ€§", C:"å°½è´£æ€§", E:"å¤–å‘æ€§", A:"å®œäººæ€§", N:"æƒ…ç»ªï¼ˆç”¨äºåå‘è®¡ç®—ç¨³å®šæ€§ï¼‰"}[code] || code;
    }

    $prev.addEventListener("click", () => {
      if (currentPage>1){ currentPage--; renderPage(); window.scrollTo({top:0,behavior:"smooth"}); }
    });
    $next.addEventListener("click", () => {
      if (currentPage<totalPages){ currentPage++; renderPage(); window.scrollTo({top:0,behavior:"smooth"}); }
    });

    // ============ æ˜Ÿåº§è®¡ç®— ============
    function calcZodiac(month, day){
      // è¥¿æ–¹æ˜Ÿåº§è¾¹ç•Œ
      const z = [
        {n:"æ‘©ç¾¯åº§", m:12, d:22}, {n:"æ°´ç“¶åº§", m:1, d:20}, {n:"åŒé±¼åº§", m:2, d:19},
        {n:"ç™½ç¾Šåº§", m:3, d:21}, {n:"é‡‘ç‰›åº§", m:4, d:20}, {n:"åŒå­åº§", m:5, d:21},
        {n:"å·¨èŸ¹åº§", m:6, d:22}, {n:"ç‹®å­åº§", m:7, d:23}, {n:"å¤„å¥³åº§", m:8, d:23},
        {n:"å¤©ç§¤åº§", m:9, d:23}, {n:"å¤©èåº§", m:10, d:24}, {n:"å°„æ‰‹åº§", m:11, d:23},
        {n:"æ‘©ç¾¯åº§", m:12, d:31}
      ];
      for (let i=0;i<z.length-1;i++){
        const cur=z[i], next=z[i+1];
        if ((month===cur.m && day>=cur.d) || (month===next.m && day<next.d)) return cur.n;
      }
      return "æ‘©ç¾¯åº§";
    }

    // æ˜Ÿåº§å±æ€§ï¼ˆå¯åœ¨æŠ¥å‘Šé¡µå±•ç¤ºï¼‰
    const ZODIAC_ATTR = {
      "ç™½ç¾Šåº§":{å…ƒç´ :"ç«", æ¨¡å¼:"åŸºæœ¬", å…³é”®å­—:["è¡ŒåŠ¨","ç›´æ¥","çƒ­æƒ…"]},
      "é‡‘ç‰›åº§":{å…ƒç´ :"åœŸ", æ¨¡å¼:"å›ºå®š", å…³é”®å­—:["ç¨³å®š","è€æ€§","äº«å—"]},
      "åŒå­åº§":{å…ƒç´ :"é£", æ¨¡å¼:"å˜åŠ¨", å…³é”®å­—:["å¤šå˜","æ²Ÿé€š","å¥½å¥‡"]},
      "å·¨èŸ¹åº§":{å…ƒç´ :"æ°´", æ¨¡å¼:"åŸºæœ¬", å…³é”®å­—:["æƒ…æ„Ÿ","ä¿æŠ¤","å®¶åº­"]},
      "ç‹®å­åº§":{å…ƒç´ :"ç«", æ¨¡å¼:"å›ºå®š", å…³é”®å­—:["è¡¨ç°","è‡ªä¿¡","åˆ›é€ "]},
      "å¤„å¥³åº§":{å…ƒç´ :"åœŸ", æ¨¡å¼:"å˜åŠ¨", å…³é”®å­—:["ç»†è‡´","æœåŠ¡","ç§©åº"]},
      "å¤©ç§¤åº§":{å…ƒç´ :"é£", æ¨¡å¼:"åŸºæœ¬", å…³é”®å­—:["å…³ç³»","å¹³è¡¡","å®¡ç¾"]},
      "å¤©èåº§":{å…ƒç´ :"æ°´", æ¨¡å¼:"å›ºå®š", å…³é”®å­—:["å¼ºåº¦","æ´å¯Ÿ","å†ç”Ÿ"]},
      "å°„æ‰‹åº§":{å…ƒç´ :"ç«", æ¨¡å¼:"å˜åŠ¨", å…³é”®å­—:["æ¢ç´¢","è¿œè§","è‡ªç”±"]},
      "æ‘©ç¾¯åº§":{å…ƒç´ :"åœŸ", æ¨¡å¼:"åŸºæœ¬", å…³é”®å­—:["ç»“æ„","è´£ä»»","ç›®æ ‡"]},
      "æ°´ç“¶åº§":{å…ƒç´ :"é£", æ¨¡å¼:"å›ºå®š", å…³é”®å­—:["ç‹¬ç«‹","åˆ›æ–°","ç†æƒ³"]},
      "åŒé±¼åº§":{å…ƒç´ :"æ°´", æ¨¡å¼:"å˜åŠ¨", å…³é”®å­—:["å…±æƒ…","æƒ³è±¡","èåˆ"]}
    };

    // ============ å¤§äº”è®¡åˆ†ï¼ˆåå‘é¢˜è‡ªåŠ¨ç¿»è½¬ï¼‰ ============
    function computeBigFive() {
      // èšåˆåˆ°ç»´åº¦
      const buckets = {O:[],C:[],E:[],A:[],N:[]};
      QUESTIONS.forEach(q=>{
        let raw = answers[q.id] ?? 50;
        // åå‘ï¼š100-raw
        let score = q.rev ? (100-raw) : raw;
        buckets[q.dim].push(score);
      });
      // å¹³å‡
      const avg = k => Math.round(buckets[k].reduce((a,b)=>a+b,0)/buckets[k].length);
      const O = avg("O");
      const C = avg("C");
      const E = avg("E");
      const A = avg("A");
      const Neuro = avg("N"); // è¿™é‡Œæ˜¯â€œä½ç„¦è™‘=é«˜åˆ†â€ï¼Œå› ä¸ºæˆ‘ä»¬æŠŠè´Ÿæ€§åå‘äº†
      // ä¸ºä¸€è‡´æ€§è¾“å‡ºâ€œæƒ…ç»ªç¨³å®šæ€§â€ï¼Œå³ Stability = Neuro
      const Stability = Neuro;

      return {
        openness: O,
        conscientiousness: C,
        extraversion: E,
        agreeableness: A,
        neuroticism: Stability  // å‘½åæ²¿ç”¨åç»­é¡µé¢å­—æ®µï¼šæƒ…ç»ªç¨³å®šæ€§
      };
    }

    // ============ å››æ¶²è´¨æ¨æ–­ï¼ˆå¯å‘å¼æ˜ å°„ï¼‰ ============
    // å–å€¼ 0~100ã€‚å¯åœ¨åç»­è”åŠ¨ä¸­å¾®è°ƒæƒé‡ã€‚
    function computeTemperaments(big5){
      const O=big5.openness, C=big5.conscientiousness, E=big5.extraversion, A=big5.agreeableness, S=big5.neuroticism; // S=æƒ…ç»ªç¨³å®šæ€§
      // å½’ä¸€å‡½æ•°
      const clamp = v => Math.max(0, Math.min(100, Math.round(v)));

      // å¤šè¡€è´¨ Sanguineï¼šå¤–å‘ + å¼€æ”¾ + å‹å–„ + ç¨³å®š
      const sanguine = clamp(0.35*E + 0.25*O + 0.2*A + 0.2*S);

      // èƒ†æ±è´¨ Cholericï¼šå¤–å‘ + å°½è´£ + ç›®æ ‡å¯¼å‘ï¼ˆç•¥ä½å®œäººï¼‰+ ç¨³å®š
      const choleric = clamp(0.35*E + 0.3*C + 0.15*S + 0.2*(100-A));

      // æŠ‘éƒè´¨ Melancholicï¼šä½å¤–å‘ + é«˜å®Œå¤‡ï¼ˆå°½è´£ï¼‰+ ä½ç¨³å®šï¼ˆæƒ…ç»ªæ³¢åŠ¨ï¼‰
      const melancholic = clamp(0.35*(100-E) + 0.3*C + 0.35*(100-S));

      // ç²˜æ¶²è´¨ Phlegmaticï¼šé«˜å®œäºº + é«˜ç¨³å®š + ä½å¤–å‘ï¼ˆæ¸©å’Œï¼‰
      const phlegmatic = clamp(0.4*A + 0.35*S + 0.25*(100-E));

      // å½’ä¸€æˆæ¯”ä¾‹ï¼ˆå¯åœ¨æŠ¥å‘Šé¡µç”»ç¯æˆ–é›·è¾¾ï¼‰
      const sum = sanguine + choleric + melancholic + phlegmatic || 1;
      return {
        sanguine: Math.round(sanguine / sum * 100),
        choleric: Math.round(choleric / sum * 100),
        melancholic: Math.round(melancholic / sum * 100),
        phlegmatic: Math.round(phlegmatic / sum * 100)
      };
    }

    // ============ ä¿å­˜æ•°æ® ============
    document.getElementById("saveBtn").addEventListener("click", () => {
      const birth = document.getElementById("birthdate").value;
      if (!birth){
        alert("è¯·å…ˆå¡«å†™ç”Ÿæ—¥~");
        return;
      }
      // ç”Ÿæ—¥åˆæ³•
      const [y,m,d] = birth.split("-").map(x=>+x);
      if (!y || !m || !d){ alert("ç”Ÿæ—¥æ ¼å¼ä¸æ­£ç¡®"); return; }

      // è®¡ç®—æ˜Ÿåº§
      const zodiac = calcZodiac(m,d);
      const zodiacAttr = ZODIAC_ATTR[zodiac];

      // å¤§äº”
      const big5 = computeBigFive();

      // å››æ¶²è´¨
      const temp4 = computeTemperaments(big5);

      // å­˜å‚¨
      localStorage.setItem("birthdate", birth);
      localStorage.setItem("zodiac", zodiac);
      localStorage.setItem("zodiacAttr", JSON.stringify(zodiacAttr));
      localStorage.setItem("scores", JSON.stringify({
        openness: big5.openness,
        conscientiousness: big5.conscientiousness,
        extraversion: big5.extraversion,
        agreeableness: big5.agreeableness,
        neuroticism: big5.neuroticism // æƒ…ç»ªç¨³å®šæ€§
      }));
      localStorage.setItem("temperaments", JSON.stringify(temp4));
      localStorage.setItem("answers", JSON.stringify(answers));

      // ä¸‹ä¸€æ­¥
      window.location.href = "step2.html";
    });

    // åˆæ¬¡æ¸²æŸ“
    renderPage();

    // å½“ç”¨æˆ·ç¬¬ä¸€æ¬¡æ»‘åŠ¨æ—¶ï¼Œå…è®¸ä¿å­˜
    document.addEventListener("input", updateSaveState);
  </script>
</body>
</html>
